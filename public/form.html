<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>email form</title>
	</head>
	<body>
		<form action="/emailPost" method="POST">
			email : <input type="text" name="email" id="email"><br>
			submit <input type="submit">
		</form>
		<button class="ajaxSend">ajax send</button>

		<div class="result"></div>
		<script>
			document.querySelector(".ajaxSend").addEventListener("click", ()=> {
				const inputData = document.forms[0].elements[0].value;
				sendAjax("http://localhost:3000/ajaxSendEmail", inputData);
			});

			const sendAjax = (url, req) => {
				let data = {"email": req};
				data = JSON.stringify(data);

				const xhr = new XMLHttpRequest();
				xhr.open("POST", url);
				xhr.setRequestHeader("Content-Type", "application/json");
				xhr.send(data);

				xhr.addEventListener("load", () => {
					let result = JSON.parse(xhr.responseText);
					if("ok" !== result.result) return;
					document.querySelector(".result").innerHTML = result.email;
				});
			}
		</script>
	</body>
</html>